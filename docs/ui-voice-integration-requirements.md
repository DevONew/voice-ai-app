# UI 개선 및 음성 기능 연동 요구사항

## 컴포넌트 구조
각 기능을 독립적인 컴포넌트로 분리:
- `VoiceButton.tsx` - 검은 원형 버튼
- `StatusText.tsx` - 상단 상태 텍스트 ("탭하여 시작", "듣는 중...", 음성 인식 텍스트)
- `ResponseDisplay.tsx` - AI 응답 표시 영역
- `VoiceRecorder.tsx` - 음성 녹음 로직
- `AudioPlayer.tsx` - 음성 재생 및 애니메이션

---

## UI 수정사항

### 1. 원 크기 조정
- 현재 크기에서 20-30% 축소
- "탭하여 시작" 텍스트와 절대 겹치지 않게
- 최대 확장 시에도 텍스트 침범 안 되도록 여백 확보

### 2. 레이아웃
- 상단: 상태 텍스트 영역 (고정)
- 중앙: 원형 버튼 (크기 변화)
- 하단: 응답 표시 영역 (필요시)

---

## 음성 인식 플로우

### 초기 상태
- 텍스트: "탭하여 시작"
- 원: 중앙, 정지 상태

### 버튼 클릭 → 음성 인식 시작
1. 텍스트: "듣는 중..." 표시
2. 음성 녹음 시작
3. 원이 음성 크기(볼륨)에 맞춰 실시간으로 커졌다 작아짐

### 음성 입력 중
- 인식된 텍스트를 실시간으로 "듣는 중..." 자리에 표시 (받아쓰기)
- 원은 계속 음성 크기에 반응

### 음성 입력 완료
1. 인식된 텍스트를 `/api/stt`로 전송
2. 텍스트를 `/api/chat`으로 전송
3. 상태: "생각하는 중..."

---

## AI 응답 단계

### 응답 받기
1. Claude API에서 응답 받음
2. 응답 텍스트를 화면에 표시 (중앙 또는 상단)
3. `/api/tts`로 텍스트 전송해서 음성 생성

### 음성 답변 중
1. **원을 화면 하단으로 이동 + 크기 축소** (30-40% 크기)
2. 응답 텍스트는 중앙에 표시
3. 음성 재생하면서 원이 음성 크기에 맞춰 애니메이션
4. 하단의 작은 원을 누르면 음성 중단 가능

### 음성 답변 완료
1. 원이 다시 중앙으로 올라옴 (원래 크기로)
2. 응답 텍스트 사라짐
3. "탭하여 시작" 상태로 복귀
4. 다음 음성 인식 대기

---

## API 연동

### STT (Speech-to-Text)
- ElevenLabs STT API 사용
- 실시간 받아쓰기 지원
- 엔드포인트: `/api/stt`

### Chat (AI 응답)
- Claude API 사용
- 시스템 프롬프트 자동 포함
- 대화 히스토리 유지
- 엔드포인트: `/api/chat`

### TTS (Text-to-Speech)
- ElevenLabs TTS API 사용
- 스트리밍 재생
- 엔드포인트: `/api/tts`

---

## 애니메이션 세부사항

### 원 크기 변화
- 음성 볼륨 0-100 기준
- 최소: 기본 크기의 85%
- 최대: 기본 크기의 115%
- transition: 0.1s ease-out (부드럽게)

### 원 위치 이동
- 중앙 ↔ 하단 이동: 0.5s ease-in-out
- 크기 변화와 동시 진행

### 텍스트 전환
- fade-in/out: 0.3s
- 부드러운 전환

---

## 상태 관리

```typescript
type AppState = 
  | 'idle'           // 대기 중
  | 'listening'      // 듣는 중
  | 'processing'     // 생각하는 중
  | 'speaking';      // 말하는 중
```

---

## 에러 처리
- API 실패 시 에러 메시지 표시
- 마이크 권한 없으면 안내
- 네트워크 오류 처리

---

## 추가 기능
- 음성 인식 중단 버튼 (필요시)
- 대화 히스토리 저장
- 음성 재생 속도 조절 (선택)
- 볼륨 조절 (선택)
